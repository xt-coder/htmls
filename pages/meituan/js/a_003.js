M.add("mt-form",function(Y){Y.namespace("mt.form");var $N=Y.Node,_3=Y.mt.util,_4=Y.Lang.isString,_5=Y.mt.lang,_6=Y.Lang.trim,_7=Y.Lang.isNumber,_8=Y.Lang.isArray,_9=Y.Lang.isObject,_a=Y.Object.isEmpty,_b=Y.mt.macro,_c=Y.io;Y.mt.form={toObject:function(_d,_e,_f,_10,_11){_d=Y.one(_d);if(_f!==false){_f=true;}if(!_d){return null;}var _12=this,_13;var _14={};if(_e){if(_8(_e)){Y.Array.each(_e,function(_15){_13=_12.getFieldValue(_d,_15);if(_f&&!Y.Lang.isArray(_13)){_13=_3.encodeText(_13);_14[_3.encodeText(_15)]=_13;}else{_14[_15]=_13;}});}else{if(_4(_e)){_13=this.getFieldValue(_d,_e);_14[_e]=_f?_3.encodeText(_13):_13;}}}else{var _16=this._serialize(_d,false,_f,_10);_14=_5.parseStr(_16,false,_10,_11);}return _14;},toString:function(_17,_18,_19,_1a){_17=Y.one(_17);if(!_17){return null;}if(!_18){return this._serialize(_17,false,_19,_1a);}return Y.mt.util.toPostData(this.toObject(_17,_18,false,_1a),_19);},getFieldValue:function(_1b,_1c){return this.field(_1b,_1c);},setFieldValue:function(_1d,_1e,_1f){return this.field(_1d,_1e,_1f);},setOptions:function(_20,_21,_22,_23){var _24=_23?_23.one(_20):Y.one(_20);var _25=this;var _26=_21.data;if(!_24){return;}_24.empty();var _27=Y.Node.getDOMNode(_24).options;if(_22){_27.add(this._buildOption("",_22));}if(_8(_26)){var key=_21["key"]||_21["keyField"]||"keyField";var _29=_21["value"]||_21["valueField"]||"valueField";Y.Array.each(_26,function(_2a){_27.add(_25._buildOption(_2a[key],_2a[_29]));});}else{if(!_a(_26)){for(var p in _26){if(_26.hasOwnProperty(p)){_27.add(this._buildOption(p,_26[p]));}}}}},field:function(_2c,_2d,_2e){if(!_2c){return "";}_2c=Y.one(_2c);var _2f=_2c.one("input[name=\""+_2d+"\"]")||_2c.one("select[name=\""+_2d+"\"]")||_2c.one("textarea[name=\""+_2d+"\"]");if(!_2f){return "";}var _30=_2f.get("type").toLowerCase();switch(_2f.get("nodeName").toLowerCase()){case "select":if(this._checkValue(_2e)){return this._setSelectValue(_2c,_2d,_2e);}else{return this._getSelectValue(_2c,_2d);}break;case "input":if(_30==="checkbox"){if(this._checkValue(_2e)){return this._setCheckboxValue(_2c,_2d,_2e);}else{return this._getCheckboxValue(_2c,_2d);}}else{if(_30==="radio"){if(this._checkValue(_2e)){return this._setRadioValue(_2c,_2d,_2e);}else{return this._getRadioValue(_2c,_2d);}}else{if(arguments.length===3){return _2f.set("value",_2e);}return _2f.get("value");}}break;case "textarea":if(arguments.length===3){return _2f.set("value",_2e);}return _2f.get("value");default:return "";}return "";},getCheckedBoxesAttr:function(_31,_32,_33){_32=_32||"value";_31=_31||"input[type=checkbox]";var _34=_33?Y.one(_33).all(_31):Y.all(_31);var arr=[];_34.each(function(_36){if(_36.get("type")==="checkbox"&&_36.get("checked")){arr.push(_36.get(_32)||_36.getAttribute(_32));}});return arr;},getRadioAttr:function(_37,_38,_39){_38=_38||"value";_37=_37||"input[type=\"radio\"]";var _3a=_39?Y.one(_39).all(_37):Y.all(_37);var ret="";_3a.some(function(_3c){if(_3c.get("type")==="radio"&&_3c.get("checked")){ret=(_6(_3c.get(_38))||_3c.getAttribute(_38));return true;}});return ret;},getOptionsText:function(_3d,_3e){if(!_3d){return null;}var s=_3d.one("select[name="+_3e+"]");if(!s){return null;}var _40;s.get("options").some(function(opt){if(opt.get("selected")){_40=opt.getHTML()||"";return true;}});return _40;},toggleCheckbox:function(_42,_43,_44){_42=Y.one(_42);if(!_42){return;}_42.on("click",function(e){var _46=_44?Y.one(_44).all(_43):Y.all(_43);if(_42.get("checked")){_46.set("checked","checked");}else{_46.set("checked",false);}});},stopEnterSubmit:function(_47){_47.delegate("keydown",function(e){if(e.keyCode===_b.key.ENTER){e.halt();}},"input[type]");},multiAction:function(_49,_4a){_49=Y.one(_49);if(!_49){return;}if(!_4a||!Y.Lang.isArray(_4a)||_4a.length===0){return;}var _4b=getSelectors(_4a);_49.delegate("click",function(e){for(var i=0;i<_4a.length;i++){var _4e=_4a[i];if(this.test(_4e.selector)){_49.set("action",_4e.action);if(_4e.callback&&typeof _4e.callback==="function"){_4e.callback(_49,this);}return;}}},_4b);function getSelectors(_4f){var _50=[];for(var i=0;i<_4f.length;i++){var _52=_4f[i];_50.push(_52.selector);}return _50.join(",");}},AjaxForm:function(_53,_54){_53=Y.one(_53);if(!_53){return;}var _55=_53.get("action")||_54.action;var _56=_53.getAttribute("method")||_54.method||"POST";var _57=_54.buttonPost?Y.one(_54.buttonPost):_53;var _58=_54.buttonPost?"click":"submit";var _59=_54.multiAction;var _5a=_54.beforeAjaxs;if(!_53.test("form")){throw new Error("\u8bf7\u4fdd\u8bc1\u4f60\u6240\u63d0\u4ea4\u7684\u5bf9\u8c61\u662f\u4e00\u4e2aform");}else{if(_6(_55)===""){throw new Error("\u8868\u5355\u63d0\u4ea4\u5730\u5740(action)\u4e0d\u80fd\u4e3a\u7a7a");}}if(_59){var _5b=getMultiTriggers(_59);_53.delegate("click",function(e){e.halt();for(var ac in _59){if(_59.hasOwnProperty(ac)){if(this.test(ac)){_55=_59[ac];if(_5a&&_5a[ac]){if(_5a[ac](this)){request(_55);}}else{request(_55);}}}}},_5b);}else{_57.on(_58,function(e){e.halt();if(_54.beforeAjax){if(_54.beforeAjax()){request(_55);}}else{request(_55);}});}function getMultiTriggers(_5f){var s=[];for(var ac in _5f){if(_5f.hasOwnProperty(ac)){s.push(ac);}}return s.join(",");}function request(_62){var _63=_c(_62,{method:_56,data:Y.mt.util.toPostData(_54.query||{}),on:{success:function(id,o){var res=_3.getEvalRes(o,"\u6743\u9650\u4e0d\u591f\u6216\u8005\u7f51\u7edc\u6709\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002");if(res.status){handleSuccess(res);}else{handleFail(res);}},failure:function(id,o){alert("\u6743\u9650\u4e0d\u591f\u6216\u8005\u7f51\u7edc\u6709\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002");}},form:{id:_53.get("id")}});}function handleFail(res){if(_54.handleFail){handleFail(res);}else{alert(res.msg);}}function handleSuccess(res){if(_54.handleSuccess){_54.handleSuccess(res);}}},clear:function(_6b,_6c){_6b=Y.one(_6b);if(!_6b){return;}_6b.all("input,select,textarea").each(function(_6d){var t=_6d.get("type"),tag=_6d.get("nodeName").toLowerCase();if(t==="text"||t==="password"||tag==="textarea"){_6d.set("value","");}else{if(!_6c){if(t==="checkbox"||t==="radio"){_6d.set("checked",false);}else{if(tag==="select"){_6d.set("selectedIndex",-1);}}}}});},reset:function(_70){_70=Y.one(_70);if(!_70){return;}if(_70.get("nodeName").toLowerCase()==="form"){_70.reset();}},_buildOption:function(_71,_72){return new Option(_72,_71);},_checkValue:function(_73){return _73!=="undefined"&&(_8(_73)||_4(_73)||_7(_73));},fillForm:function(_74,_75){var _76=Y.one(_74);if(!_76||!_75){return false;}if(!Y.Object.isEmpty(_75)){for(var _77 in _75){if(_75.hasOwnProperty(_77)){this.field(_76,_77,_75[_77]);}}}return true;},serialize:function(_78,_79,_7a,_7b){return this._serialize(Y.one("#"+_78),_79,_7a,_7b);},_serialize:function(_7c,_7d,_7e,_7f){if(!_7c){return "";}if(_7e!==false){_7e=true;}var _80=_7c.all("input, select, textarea");var _81=[],_82=this;_80.each(function(){if((!this.get("disabled")||_7d)&&this.get("name")){var _83=this.get("type"),_84=this.get("name"),_85;switch(_83){case "radio":case "checkbox":var _86=this.get("checked");if(_86){_81.push(_3.joinKeyValue(_84,this.get("value"),_7e));}break;case "select-one":_85=this.get("selectedIndex");if(_85>-1){var _87=Y.Node.getDOMNode(this).options[_85],_88=_87.attributes.value&&_87.attributes.value.specified?_87.value:_87.text;_81.push(_3.joinKeyValue(_84,_88,_7e));}break;case "select-multiple":_85=this.get("selectedIndex");if(_85>-1){var _89=this.get("options");_89.each(function(){var _8a=Y.Node.getDOMNode(this);if(_8a.selected){_88=_8a.attributes.value&&_8a.attributes.value.specified?_8a.value:_8a.text;_81.push(_3.joinKeyValue(_84,_88,_7e));}});}break;case "file":case undefined:case "reset":case "button":case "image":case "submit":break;default:_81.push(_3.joinKeyValue(_84,this.get("value"),_7e));break;}}});if(_7f!==undefined&&Y.Lang.isString(_7f)){return _81.join(_7f);}return _81.join("&");},_getCheckboxValue:function(_8b,_8c){var _8d=[];var c=_8b.all("input[name=\""+_8c+"\"]");c.each(function(_8f){if(_8f.get("checked")){_8d.push(_6(_8f.get("value")));}});return _8d;},_setCheckboxValue:function(_90,_91,_92){var c=_90.all("input[name=\""+_91+"\"]");if(!c){return false;}var _94=false;c.each(function(_95){var _96=_6(_95.get("value"));if(_4(_92)&&_92.indexOf(",")!==-1){_92=_92.split(",");}if(_8(_92)){_94=Y.mt.lang.inArray(_96,_92);}else{if(_4(_92)||_7(_92)){_94=(_96===_92.toString());}}_95.set("checked",_94&&"checked");});return true;},_getRadioValue:function(_97,_98){var _99=_97.all("input[name=\""+_98+"\"]"),val=null;_99.some(function(nd){if(nd.get("checked")){val=_6(nd.get("value"));return true;}});return val;},_setRadioValue:function(_9c,_9d,_9e){var r=_9c.all("input[name=\""+_9d+"\"]");if(!r){return false;}r.some(function(_a0){if(_6(_a0.get("value"))===_9e.toString()){_a0.set("checked","checked");return true;}});return true;},_getSelectValue:function(_a1,_a2){var s=_a1.one("select[name=\""+_a2+"\"]");if(!s){return null;}if(!s.get("multiple")){return s.get("value");}var res=[];s.get("options").each(function(opt){if(opt.get("selected")){res.push(_6(opt.get("value"))||opt.get("text"));}});return res;},_setSelectValue:function(_a6,_a7,_a8){var s=_a6.one("select[name=\""+_a7+"\"]");if(!s){return false;}s.get("options").some(function(opt){if(_6(opt.get("value"))===_a8.toString()){opt.set("selected","selected");return true;}});return true;},disableSubmit:function(_ab,_ac,_ad){var _ae={},_af={"background-color":"#EEE"},_b0="";_ab=Y.one(_ab);_ad=_ad||{};if(!_ac){Y.mix(_ad,_af);}_ac=_ac?_ac:"disabled";if(!_ab){return;}_ae.className=_ac;_ae.styles="";_b0=Y.Node.getDOMNode(_ab).getAttribute("style");if(typeof _b0==="string"){_ae.styles=_b0;}else{_ae.styles=_b0=_b0?_b0.cssText:"";}_ab.setData("backupStyles",_ae);_ab.setAttribute("disabled","disabled");_ab.addClass(_ac);for(var p in _ad){if(_ad.hasOwnProperty(p)){_b0+=";"+p+":"+_ad[p];}}_ab.removeAttribute("style");_ab.setAttribute("style",_b0);_ab._node.style.cssText=_b0;},enableSubmit:function(_b2){var _b3=null;_b2=Y.one(_b2);if(!_b2){return;}_b2.removeAttribute("disabled");_b3=_b2.getData("backupStyles");if(_b3){_b2.removeClass(_b3.className);_b2.removeAttribute("style");_b2.setAttribute("style",_b3.styles);_b2._node.style.cssText=_b3.styles;}},toJSON:function(_b4,_b5){_b4=Y.one(_b4);if(!_b4){return false;}var _b6=this._serialize(_b4,_b5,true);var _b7=_5.parseStr(_b6,false,null);var _b8={},_b9=decodeURIComponent;for(var p in _b7){if(_b7.hasOwnProperty(p)){this._parseArr(_b8,_b9(p),_b9(_b7[p]));}}return _b8;},_execStr:function(str){var _bc;var e=/(\w+)(["']?)(\]?)(\[?)(["']?)/g;var _be=[];while((_bc=e.exec(str))!==null){_be.push(_bc);if(_bc[3]){e.lastIndex=e.lastIndex-_bc[3].length;}}return _be;},_parseArr:function(s,str,val){var ss=s;str=str.replace(/\.(\w+)/g,"[\"$1\"]");var arr=this._execStr(str);Y.Array.each(arr,function(i){var _c5=i[1];if(Number(_c5)){_c5=Number(_c5);}if(ss[_c5]===undefined){if(i[4]&&i[5]){ss[_c5]={};}else{if(i[4]){ss[_c5]=[];}else{ss[_c5]=val||"";}}}ss=ss[_c5];});}};},"1.0.0",{requires:["mt-base","io-base"]});
M.add("www-index",function(Y){var _2=Y.UA.ie,_3=Y.UA.webkit,_4=(_2===6);var _5=Y.mt.util,_6=Y.io;Y.namespace("mt.www.Index");Y.mt.www.Index={initMall:function(){var _7=this,_8=Y.one("#mall-container");if(!_8){return;}Y.one(".site-more").setHTML(_8.get("value"));_7.showGeoMask(".mall",".deal-tile");_7.initSideNavbar();Y.mt.LazyLoader.run(".mall");},initAsyncLoading:function(_9){var _a=Y.one(_9.ndContainer);if(!_a){return;}var _b={loadThreshold:2,dealsPerLoad:24,maxLoads:5};Y.mix(_9,_b);var _c=1,_d=_a.getY(),_e=_a.get("offsetHeight"),_f=Y.one("window"),_10=_a.get("winHeight"),_11,_12,_13=_9.dealids.split(","),_14=null;_11=_f.on("resize",_5.throttle(function(){_10=_a.get("winHeight");check();},100));_12=_f.on("scroll",_5.throttle(check,100));check();function check(){var _15=_f.get("docScrollY"),_16=_10*_9.loadThreshold;if(_d+_e-_15<_16){loadMore();}}function loadMore(){if(_14&&_14.isInProgress()){return;}var _17=_c*_9.dealsPerLoad;if(_17>=_13.length){stop();return;}var _18=_9.data,_19=_a.one(".deals-async-loading");if(!_19){_19=_a.appendChild("<div class=\"deals-async-loading\"><div class=\"deals-async-loading__tips\"><i></i>\u52a0\u8f7d\u4e2d</div></div>");}else{_19.show();}_18.offset=_17;_18.dealids=_13.slice(_17,_17+_9.dealsPerLoad).join(",");_14=_6(_9.action,{method:"post",data:_5.toPostData(_18),on:{success:function(id,o){var res=_5.getEvalRes(o);_19.hide();if(res.status&&res.data!==""){_a.insertBefore(res.data,_19);Y.mt.LazyLoader.run(_9.ndContainer);_c++;if(_c===_9.maxLoads){stop();return;}_e=_a.get("offsetHeight");}else{stop();}},failure:function(){_19.hide();stop();}}});}function stop(){_11.detach();_12.detach();if(typeof _9.afterCallback==="function"){_9.afterCallback();}}},initSideNavbar:function(){var _1d=Y.one("#side-navbar");if(!_1d){return;}Y.use("w-fixedbar",function(Y){new Y.mt.widget.Fixedbar({node:"#side-navbar",vAlign:"top",vTopOffset:100,mainAreaWidth:980,hAlign:"left",topEdge:".site-ms",isStaticBottomEdge:true,bottomEdge:Y.one(".site-ms").get("region").bottom});});_1d.delegate("click",function(){var nd=this,_20=_5.data(nd,"anchor"),_21=Y.one(_20),_22=5,_23=0;if(!_21){return;}_23=_21.getY()-_22;if(_2===8){window.scrollTo(0,_23);}else{_runAnim(_23);}},".side-navbar__item");_1d.one(".side-navbar__gotop").on("click",function(){_runAnim(0);});function _runAnim(_24){var _25=_3?document.body:document.documentElement;new Y.Anim({node:_25,duration:0.3,to:{scroll:[0,_24]},easing:"easeOutStrong"}).run();}},toggleDestination:function(nd){nd=Y.one(nd);var _27=nd&&nd.one(".J-city-list");if(!_27){return;}var _28=_27.all("a"),_29=nd.all(".J-sub-city-list"),_2a="current",_2b;_28.some(function(nd,_2d){if(nd.ancestor(".item").hasClass(_2a)){_2b=_2d;return true;}});_27.delegate("click",function(e){e.halt();var _2f=_28.indexOf(this);if(typeof _2b!=="undefined"){_28.item(_2b).ancestor(".item").removeClass(_2a);_29.item(_2b).hide();}_2b=_2f;_28.item(_2f).ancestor(".item").addClass(_2a);_29.item(_2f).show();},"a");},toggleDestinationNew:function(nd){nd=Y.one(nd);var _31=nd&&nd.one(".J-city-list");if(!_31){return;}var _32=_31.all("a"),_33=nd.all(".J-sub-city-list"),_34="current",_35;_32.some(function(nd,_37){if(nd.hasClass(_34)){_35=_37;return true;}});_31.delegate("click",function(e){e.halt();var _39=_32.indexOf(this);if(typeof _35!=="undefined"){_32.item(_35).removeClass(_34);_33.item(_35).hide();}_35=_39;_32.item(_39).addClass(_34);_33.item(_39).show();},"a");},storeScrollInfo:function(_3a){_3a=Y.one(_3a);if(!_3a){return;}var _3b=Y.one(window),_3c=_5.Cookie.getExpiresDate(0,0,10),_3d="dsy",_3e=50,_3f=_3b.get("docScrollY"),_40=_5.Cookie.get(_3d);if(_40>0){if(_40-_3f>_3e){window.scrollTo(_3b.get("docScrollX"),_40);}_5.Cookie.remove(_3d,"/","."+M.DOMAIN_HOST);}_3a.delegate("click",function(){var _41=_3b.get("docScrollY"),_42=this.getAttribute("target");if(_42==="_blank"){return;}_5.Cookie.set(_3d,_41,_3c,"/","."+M.DOMAIN_HOST);},"a");},showGeoMask:function(_43,_44,_45){_44=_44||".item";var _46=200;_45=_45&&_4;Y.one(_43).all(_44).each(function(nd){var _48,geo=nd.one(".trade-geo");if(_45){nd.on("hover",function(){this.addClass("hover");},function(){this.removeClass("hover");});}if(geo){nd.on("hover",function(){window.clearTimeout(_48);_48=window.setTimeout(function(){geo.addClass("geo-hover");},_46);},function(){window.clearTimeout(_48);_48=window.setTimeout(function(){geo.removeClass("geo-hover");},_46);});}});}};},"1.0.0",{requires:["www-base","mt-form"]});
M.add("mt-lazyloader",function(Y){var _2=Y.Array;var _3=Y.Lang;var _4=Array.prototype.slice;var _5=Y.one(window);var _6=Y.one(document);var _7=function(nd,_9){var _a=_5.get("docScrollY");return _a>=(nd.getY()+nd.get("region").height+_9);};var _b=function(nd,_d){var _e=_5.get("winWidth")+_5.get("docScrollX");return _e<=(nd.getX()-_d);};var _f=function(nd,_11){var _12=_5.get("winHeight")+_5.get("docScrollY");return _12<=(nd.getY()-_11);};var _13=function(nd,_15){var _16=_5.get("docScrollX");return _16>=(nd.getX()+nd.get("region").width+_15);};function LazyLoader(_17){LazyLoader.superclass.constructor.apply(this,arguments);return LazyLoader.getInstance(this);}LazyLoader.getInstance=function(){var _18;return function(_19){if(typeof _18==="undefined"){_18=_19;}return _18;};}();LazyLoader.run=function(_1a){var _1b;var _1c=_4.call(arguments,0);if(_3.isObject(_1a)){_1c.shift();}else{_1a={};}_1b=new LazyLoader(_1a);return _1b.run.apply(_1b,_1c);};LazyLoader.CLASS_LOADED="lazyloaded";LazyLoader.NAME="LazyLoader";LazyLoader.ATTRS={threshold:{writeOnce:true,getter:function(val){return val||_5.get("winHeight");}},imgSrcParser:{writeOnce:true,value:function(_1e){var _1f=Y.mt.util.decodeAttr(_1e,"params");return _1f?_1f.source:null;}},imgList:{setter:function(_20,_21){var _22=this.get(_21)||[];var _23=this.get("imgSrcParser");Y.all(_20).each(function(_24){_24.all("img").each(function(_25){if(_23(_25)){_22.push(_25);}});});return _22;},getter:function(_26){var _27=[];var th=this.get("threshold");var _29=this.get("imgSrcParser");_2.each(_26,function(_2a){var src;if(!_7(_2a,th)&&!_b(_2a,th)&&!_f(_2a,th)&&!_13(_2a,th)){if((src=_29(_2a))&&!_2a.hasClass(LazyLoader.CLASS_LOADED)){_2a.set("src",src);_2a.addClass(LazyLoader.CLASS_LOADED);}}if(!_2a.hasClass(LazyLoader.CLASS_LOADED)){_27.push(_2a);}},this);return _27;}}};var _2c={initializer:function(cfg){this.timer=null;this.subs=null;this.after("imgListChange",function(){if(this.subs){return;}var _2e=function(){if(this.timer){return;}var _2f=this;this.timer=window.setTimeout(function(){if(_2f.get("imgList").length===0){_2f.subs.scroll.detach();_2f.subs.resize.detach();_2f.subs=null;}_2f.timer=null;},100);};this.subs={};this.subs.scroll=_5.on("scroll",_2e,this);this.subs.resize=_5.on("resize",_2e,this);},this);},add:function(_30){this.set("imgList",_30);return this;},run:function(_31,_32,_33){if(typeof _31==="undefined"&&this.get("imgList")===[]){_31=_6;}if(_3.isNumber(_32)){this.set("threshold",_32);}else{if(_3.isFunction(_32)){_33=_32;}}if(_3.isFunction(_33)){this.set("imgSrcParser",_33);}this.set("imgList",_31);return this;}};Y.extend(LazyLoader,Y.Base,_2c);Y.mt.LazyLoader=LazyLoader;},"1.0.0",{requires:["mt-base","base-base"]});